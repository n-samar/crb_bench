\begin{figure}
\begin{lstlisting}[escapechar=!,label=lst:bpModDown,caption={
  Implementation of \texttt{bpModDown}.
}]
def bpModDown(ct: Ct) -> Ct:
  # Q[L] is product of residue moduli at level L
  K = Q[L] * S[L-1] / (Q[L-1]*S[L]) # precomputed
  ct = mulConst(ct, K)
  return !\color{magenta}{bpRescale}!(ct)
\end{lstlisting}
\vspace{-0.1in}
\end{figure}
